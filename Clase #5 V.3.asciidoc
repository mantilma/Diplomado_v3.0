# Acquisto, Custodia e Trasferimento di bitcoin

### Punti di entrata ed uscita

- Il primo passo per ottenere bitcoin è acquistarlo. Ci sono diverse alternative:
    - exchanges, brokers, ATM, società fintech, carte regalo, ecc.
- Il denaro convenzionale (euro, dollari, ecc.) viene scambiato con il suo equivalente in bitcoin.
- I servizi che questi servizi forniscono sono "punti di accesso"
- I governi possono regolamentare i punti di ingresso e di uscita
    - Potrebbero vietare alle banche di inviare denaro a/da un exchange di bitcoin.
        - Il che limiterebbe la nostra capacità di acquistare e vendere bitcoin ma,
            - è impossibile **impedire l'invio/la ricezione di bitcoin.**

## Ho abbastanza soldi per comprare bitcoin?

- BTC è l'unità comune della moneta bitcoin.
- Il simbolo ₿ può essere utilizzato nello stesso modo in cui USD o $ vengono utilizzati per riferirsi a bitcoin
- bitcoin ha un controvalore equivalente in ogni valuta del mondo in un dato momento.
- Esempio: 1 BTC = US $ 21.464 e 1 ₿ = $ 95.288.229 COP (pesi colombiani) in questo istante
- Bitcoin è molto più divisibile di $ 1 USD, $ 1 USD = 100 centesimi. Non esiste una quantità come 1/2 centesimo. o 1/10 di centesimo.
- Un **Satoshi** (o Sat in breve), è la denominazione più bassa nella valuta bitcoin
- 1 BTC = 100,000,000 sats ≈ 0.0003 USD (oggi)
- Ciò significa che un bitcoin può essere diviso in cento milioni di unità.

**Bias unitario**   Falsa credenza **….**

- Non si deve acquistare 1 bitcoin intero; possiamo acquistare tutti i Sat che vogliamo.

> ‘Se lo aggiungi poco a poco e lo fai spesso, presto diventerà molto.” Hesíodo
> 

### Come viene tenuto in custodia **bitcoin?**

Quando i Sats vengono acquistati su un sito web,

- molto probabilmente li accrediteranno su un conto virtuale
    - Simile a ricevere un credito su un conto bancario quando il denaro viene trasferito su di esso
- Potrebbe sembrare che la persona possieda i suoi bitcoin,
    - ma in realtà i bitcoin sono in possesso di terzi.

Dunque,

- È importante comprendere i rischi dell'investimento in bitcoin ed iniziare a:
    - conoscere i modi migliori per mantenere i bitcoin sul mercato
    - Scoprire cos'è un "portafoglio" o wallet
        - Quale offre la migliore sicurezza?
        - Come scegliere il più adatto alle esigenze di ogni persona
    - Analizzare i vantaggi e gli svantaggi dei portafogli che scegliamo di utilizzare
        - Comprendere che non esiste un portafoglio ideale che soddisfi tutte le esigenze
    

## **Tipi di portafogli & lightning**

### Chi controlla il mio bitcoin?

- **Portafogli con auto-custodia**:

Benefici:

- È l'unico modo per diventare il proprietario assoluto del bitcoin che è stato acquistato
- Non è necessario chiedere il permesso per utilizzare il servizio.
- Non esiste un processo di approvazione dell'account.
- Chiunque nel mondo può scaricare l'app e usarla subito.
    - È come tenere i soldi a casa invece di affidarli alla banca
        - L'autocustodia dei nostri bitcoin è altamente raccomandata per evitare furti.
- Nessuna società o governo ha il controllo o l'autorità sulle transazioni
- Nessun soggetto terzo può confiscare arbitrariamente ciò che è in autocustodia.
    - In tempi di stress, siamo sicuri che il nostro bitcoin sia al sicuro.

Rischi:

- Non c'è modo di recuperare i fondi in caso di smarrimento delle “chiavi private”.
- Non esiste un servizio clienti
- La responsabilità non è distribuita

- **Portafogli di custodia (una terza parte custodisce il tuo bitcoin)**:
    - I fondi (chiavi private) sono sotto il controllo del fornitore del servizio di custodia
    - Vantaggio: se perdi o dimentichi l'accesso al tuo conto, il denaro viene facilmente recuperato
    - Rischio: sempre connessi a Internet, il che li rende più vulnerabili.


## Qual è il portafoglio più conveniente?

- **Cold Wallets (Portafogli "freddi")**

**Hardware**: 

- Portafogli "non connessi", poiché, come suggerisce il nome, non richiedono Internet.
- I portafogli più sicuri esistenti.
- Ideale per conservare grandi quantità di bitcoin
- Le tue chiavi sono memorizzate su un dispositivo hardware. [Esempio: Coldcard MK3.]
- La perdita del portafoglio senza backup si traduce in fondi irrecuperabili

**Paper Wallets (Portafogli Cartacei)**: 

- Le chiavi private vengono copiate su carta come forma di protezione.
- Uno dei modi più sicuri ma estremamente inefficiente per conservare BTC,
- È necessario copiare una nuova chiave privata ogni volta che viene effettuata una transazione

**Hot Wallets (Portafogli Software)**:
    - connessi ad Internet
    - Possono essere installati e/o accessibili tramite un'applicazione mobile o via web.
        
** Mobile Wallets**
        
        - Portatili e convenienti; ideale quando si effettuano transazioni di persona
        - I vari App store potrebbero rimuoverli senza preavviso
        - Se il dispositivo è danneggiato o smarrito, può essere difficile recuperare i fondi
        - Ideali per l'uso con i codici QR
        
**Desktop Wallets**
        
        - Gli utenti possono avere il controllo completo sui fondi
        - Alcuni offrono supporto per cold wallets
        - Difficile utilizzare i codici QR durante le transazioni
        - Suscettibili ai virus informatici che rubano bitcoin

**Architettura dei portafogli Bitcoin**
    
 

### Come invio/ricevo satoshi?

**On-chain: 

- Attraverso portafogli collegati alla rete "principale".
- Questo è un modo molto sicuro ma molto lento, fino a 10 min. per confermare la transazione
- Le commissioni di ogni transazione sono proporzionali alla sua dimensione digitale, non al suo importo.
    - Se invii un valore di $ 1 USD on-chain e $ 1 viene pagato in commissioni, questo rappresenta il 100%
    - Se invii $ 10.000 sulla catena e $ 1 viene pagato in commissioni, questo rappresenta lo 0,01%.

**Lightning Network (off-chain)**: 

- Una soluzione di "livello 2": consente di inviare e ricevere bitcoin
    - pagando commissioni molto basse o nulle e
    - in modo eccezionalmente rapido.
- Sono utilizzati nei paesi in cui:
    - le politiche e le normative locali incoraggiano l'adozione di massa e
    - è richiesta una soluzione di transazione veloce, privata, economica ed efficiente.
    

# **Il ciclo di una transazione (on-chain)**

## Que es una transacción de Bitcoin?

Lo que se envía y se guarda a través del protocolo Bitcioin es bitcoin, no son pesos ni dólares. 

- A esta transferencia de dinero es lo que se le llama una transacción.
- Un traspaso de valor entre dos monederos, el cual queda grabado en la blockchain (Bitcoin).



Cuando una nueva transacción ingresa a la red, 

- debe pasar un proceso de verificación para ser aceptada por los nodos
    - Las transacciones válidas
        - se transmiten de una computadora a otra hasta que todas tengan copia.
        - Aproximadamente cada diez minutos se agrupan miles de transacciones,
        - y se crea un nuevo bloque, a través de un proceso llamado minería.
        - Las nuevas transacciones quedan grabadas en el bloque para siempre,
        - será imposible modificarlas, borrarlas o agregarles información.
    - Las transacciones inválidas
        - simplemente se rechazan y no se propagan por la red

## Puentes y paradas para realizar transacciones y guardar BTC

Una transacción a través de un monedero se asemeja al siguiente proceso:

- Imaginemos como si todo el bitcoin en existencia estuviese guardado cajas de seguridad,
    - todas con diferente cantidad de BTC, pero completamente transparentes.
    - Cualquiera pudiese ver cuanto bitcoin hay en cada caja y el historial de cómo llegó allí


- Cada caja tiene una **dirección** perteneciente a un sólo dueño,
- Esta está protegida con un candado de seguridad, el cual necesita dos llaves diferentes
- Una de las llaves (**la llave privada**) **abre** el candado y **da acceso al BTC adentro**,
- La otra llave (**la llave pública**) **cierra** el candado y **protege el BTC**
- Cada participante en la red **guarda** sus **llaves privadas** en lugares muy seguros
- Si una caja tiene bitcoin, el dueño en cualquier momento puede abrir su caja y:
    - trasladar cualquier cantidad de fondos deseada otra caja diferente
    - pero antes, tomando en cuenta que existen miles y miles de cajas,
        - necesita una dirección exacta, para garatizar que se va a depositar el BTC  a la caja correcta.
    

    
    - Por último, cerrar el candado de caja fuerte con la llave pública del recipiente
        - para que nadie, fuera del destinatario, tenga acceso a dicho bitcoin
- En el futuro, la caja sólo se podrá abrir con la llave privada de quién recibió el BTC.


## **Cómo funciona una transacción paso a paso?**

El éxito de transferir dinero en una red descentralizada solo se logró bajo la premisa que cada transacción es única y reconocible.   



Supongamos que Marc va a enviar 0.5 bitcoin a su hermano Roby. Ambos tienen monederos.

- Es necesario crear una transacción que lleve un **identificador único e irrepetible**.
    - Este identificador es la **huella digital** de cada transacción
    - Esto es así para evitar que dos transacciones pasen por ser idénticas,
    - y el proceso de verificación sea sencillo.
        - Para que esto suceda de manera segura pero eficiente,
            - se requiere cifrar, descifrar, firmar y verificar cada transacción.

A. **Cifrar**: Marc tiene que enviar el Bitcoin a través de un canal inseguro sin que nadie lo intercepte. 

B. **Descifrar**: Roby tiene que recibir el dinero, asegurarse que nadie más tenga acceso a él y poder usarlo.

C. **Firmar**: Marc tiene que comprobarle a Roby que el dinero que envió si le pertenecía a el originalmente y que está mandando la cantidad correcta.

D. **Verificar**: Los usuarios en la red tienen que verificar que Marc si tenía ese dinero en su cuenta para gastar, lo tienen que deducir de la cuenta de Marc, y agregarlo a la cuenta de Roby. 

**Miremos como sucede:**

1. Marc abre su monedero en su celular y le pide la dirección de envío a Roby,  
2. Roby se la comparte (en forma de código QR, texto, correo electrónico u otros métodos), 
3. En esta transacción, Marc escanea el código QR y lo vincula a la cantidad que desea enviar
    - agregando una comisión pequeña como incentivo para que los **mineros** la seleccionen,
4. con un click en un botón, se verifica si Marc tiene suficiente fondos en su monedero 
5. El monedero de Marc **firma** la transacción **** con su clave privada, 
    - su bitcoin se vuelve disponible para Roby
6. La transacción se transmite a través de la red a los **nodos** para ser ver si es aprobada
    - Después de ser verificada, permanece en un área de espera
7. Los **nodos mineros** seleccionan miles de transacciones y rechazan las inválidas 
    - Las agregan sus nuevos “bloques candidatos”, los cuales no han sido aceptados
    - Comprimen toda la información y cada uno crea un identificador de bloque.
8. Comienza una competencia entre **nodos (**similar a una rifa entre identificadores de bloque)
    - para ver a quién es el próximo en agregar su bloque a la cadena de bloques
9. El bloque ganador contiene la transacción de Marc-Roby y lo propaga a otros nodos
10. Los nodos verifican el identificador del bloque ganador y lo agregan a la cadena de bloques
    - Todas las transacciones en dicho bloque quedan **confirmadas** en la cadena de bloques
    - no habrá forma de modificar o borrar. Quedará registrado ****para siempre en su lugar.
11. Roby se convierte en el propietario acreditado de ese **bitcoin**  
    - Habrá recibido sus 0.5 BTC en aproximadamente 10 minutos
    - Marc lo verá  restado del balance de su **monedero**
12. La transacción habrá terminado con éxito.

## UTXO-“Monedas no Gastadas” o “Unspent Transaction Output”

Las transacciones son simplemente **entradas** y **salidas** de bitcoin de un monedero a otro

- Todo bitcoin que todavía no se haya gastado se considera “**UTXO**”, **monedas no consumidas**
- El **estado actual** de la cadena de bloques es la base de datos **UTXO**.
- Las **entradas** se refieren al dinero que se usa para **generar una transacción**
- Las **salidas** indican generalmente dos puntos a los que se **dirige la transacción**:
    - Una salida va a la persona a la que se realiza el pago
- Cuando un usuario desbloquea su UTXO con su clave privada para enviarle a otro,
    - su saldo puede estar en peligro, ya que su caja de seguridad está abierta.
    - Por este motivo, es recomendable siempre mandar cualquier saldo a un monedero nuevo
- Si el monedero original tiene un saldo:
    - la otra salida se dirige a una dirección nueva creada para recibir el cambio
        - convirtiendo esta cantidad en una entrada nueva UTXO
- Para los nodos en la red, es fácil llegar a un consenso ya que:
    - todos mantienen una copia de la misma base de datos
    - pueden comprobar los saldos de cada una de las direcciones.

## La confirmación de una transacción

- Para autorizar y **enviar** cualquier **salida** de bitcoin de un monedero,
    - se debe **firmar** la transacción con la **clave privada**.
    - Este paso es necesario para probar que uno es el propietario de sus fondos.
- Para **recibir** una **entrada** a un monedero,
    - un usuario debe haber compartido su **dirección** con el emisario.
- La transferencia se **CONFIRMA** cuando,
    - Bitcoin **ha apuntado** la cantidad de bitcoin que se depositó  **a la nueva dirección**
    - y la **ha restado** del monedero **de quien lo envió**.

Visualicemos cómo se **confirma** una transacción:

- Las cajas amarillas representan UTXO y
- las cajas grises representan monederos en los que ya no hay bitcoin (completamente vacías).
- Diagrama #1:
    - El nodo confirma que si había suficiente bitcoin apuntando a la dirección original  (0.5 BTC en el monedero de Marc) para ejecutar la transacción
    - Cuando se confirma la transacción, se ha repartido cierta cantidad de bitcoin a dos direcciones diferentes.
    - Algunas cajas ahora tienen más bitcoin (la de Roby), y la original, menos….o nada.
 

Después de haber confirmado la transferencia, la blockchain solo se encargará de monitorear los monederos que recibieron dinero, el de 1.5BTC, y el de 0.5BTC. 

- Este es ahora el bitcoin no gastado o el UTXO.

